<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Light Footer</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700;800&display=swap');
        
        :root {
            --bg-color: #1a1a1a;
            --text-color: #ffffff;
            --accent-color: #ffc233;
            --secondary-accent: #4ecdc4;
        }

        * {
            box-sizing: border-box;
        }

        body { 
            margin: 0; 
            padding: 4rem 2rem; 
            font-family: 'Outfit', sans-serif; 
            overflow: hidden; 
            background: var(--bg-color); 
            color: var(--text-color); 
            border-radius: 48px 48px 0 0; 
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .top-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr 1fr;
            gap: 3rem;
            margin-bottom: 4rem;
        }

        .brand-col {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .brand { 
            font-size: 2.5rem; 
            font-weight: 800; 
            color: var(--text-color); 
            text-decoration: none; 
            letter-spacing: -0.03em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .brand span { color: var(--accent-color); }

        .desc { 
            color: rgba(255,255,255,0.6); 
            line-height: 1.6; 
            max-width: 300px; 
        }

        .newsletter {
            background: rgba(255,255,255,0.05);
            padding: 0.5rem;
            border-radius: 50px;
            display: flex;
            border: 1px solid rgba(255,255,255,0.1);
            margin-top: 1rem;
            width: 100%;
        }

        .newsletter input {
            background: transparent;
            border: none;
            color: #fff;
            padding: 0.8rem 1.5rem;
            flex: 1;
            outline: none;
            font-family: inherit;
            min-width: 0;
        }

        .newsletter button {
            background: var(--accent-color);
            color: #1a1a1a;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .newsletter button:hover { transform: scale(1.05); }

        .link-col h4 {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0 0 1.5rem 0;
            color: var(--text-color);
        }

        .link-col a {
            display: block;
            color: rgba(255,255,255,0.6);
            text-decoration: none;
            margin-bottom: 0.8rem;
            transition: color 0.2s, transform 0.2s;
        }
        .link-col a:hover { color: var(--secondary-accent); transform: translateX(5px); }

        .bottom-bar {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .copyright { color: rgba(255,255,255,0.4); font-size: 0.9rem; }

        .socials { display: flex; gap: 1rem; }
        .social-icon {
            width: 40px; height: 40px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: #fff;
            text-decoration: none;
            transition: background 0.2s, transform 0.2s;
        }
        .social-icon:hover { background: var(--secondary-accent); color: #1a1a1a; transform: translateY(-3px); }

        @media (max-width: 900px) {
            .top-grid { grid-template-columns: 1fr 1fr; }
            .brand-col { grid-column: span 2; }
        }
        @media (max-width: 600px) {
            .top-grid { grid-template-columns: 1fr; }
            .brand-col { grid-column: span 1; }
            .bottom-bar { flex-direction: column; text-align: center; }
            .newsletter{flex-direction: column; gap: 0.5rem; width: 80vw;}
        }

        /* Loading & Error States */
        #loading, #error-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: var(--bg-color); color: var(--text-color); z-index: 9999;
        }
        #error-screen { background: #fee2e2; color: #b91c1c; display: none; }
        #content { display: none; width: 100%; }
    </style>
</head>
<body>
    <div id="loading">
        <div>üîí Verifying...</div>
    </div>
    <div id="error-screen">
        <h3>Access Denied</h3>
        <p id="error-msg">Invalid Token</p>
    </div>

    <div class="container" id="content">
        <div class="top-grid">
            <div class="brand-col">
                <a href="#" class="brand" id="brand">Brand<span>.</span></a>
                <p class="desc" id="desc">Creating beautiful digital experiences for everyone.</p>
                <div class="newsletter">
                    <input type="email" placeholder="Enter your email...">
                    <button id="sub-btn">Join</button>
                </div>
            </div>
            
            <div class="link-col" id="col1">
                <h4 id="col1-title">Product</h4>
                <!-- Links injected here -->
            </div>
            
            <div class="link-col" id="col2">
                <h4 id="col2-title">Company</h4>
                <!-- Links injected here -->
            </div>
            
            <div class="link-col" id="col3">
                <h4 id="col3-title">Resources</h4>
                <!-- Links injected here -->
            </div>
        </div>

        <div class="bottom-bar">
            <div class="copyright" id="copy">¬© 2025 Brand. All rights reserved.</div>
            <div class="socials">
                <a href="#" class="social-icon">ùïè</a>
                <a href="#" class="social-icon">in</a>
                <a href="#" class="social-icon">Ig</a>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyC4qRfl2vU7rWZlQsgN5ikrtLTgzS9ehN4", authDomain: "komutheme.firebaseapp.com", projectId: "komutheme", storageBucket: "komutheme.firebasestorage.app", messagingSenderId: "27957638694", appId: "1:27957638694:web:daf2e849b28b46740e58e7" };
        const app = initializeApp(firebaseConfig); const auth = getAuth(app); const db = getFirestore(app);

        const params = new URLSearchParams(window.location.search);
        const token = params.get('token');
        const frameId = params.get('frame_id');

        async function verifyToken() {
            if (!token) return showError("No token provided.");
            try {
                await signInAnonymously(auth);
                const q = query(collection(db, "users"), where("premiumToken", "==", token));
                const querySnapshot = await getDocs(q);
                if (!querySnapshot.empty) {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('content').style.display = 'block';
                    renderContent();
                } else showError("Token not found.");
            } catch (e) { console.error(e); showError("Verification failed."); }
        }

        function showError(msg) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error-screen').style.display = 'flex';
            document.getElementById('error-msg').innerText = msg;
            sendHeight();
        }
        
        function renderContent() {
        // Colors
        if(params.get('bg_color')) document.documentElement.style.setProperty('--bg-color', '#' + params.get('bg_color'));
        if(params.get('text_color')) document.documentElement.style.setProperty('--text-color', '#' + params.get('text_color'));
        if(params.get('accent_color')) document.documentElement.style.setProperty('--accent-color', '#' + params.get('accent_color'));
        if(params.get('secondary_accent')) document.documentElement.style.setProperty('--secondary-accent', '#' + params.get('secondary_accent'));

        // Content
        if(params.get('brand')) document.getElementById('brand').innerHTML = params.get('brand');
        if(params.get('description')) document.getElementById('desc').textContent = params.get('description');
        if(params.get('copyright')) document.getElementById('copy').textContent = params.get('copyright');
        if(params.get('sub_text')) document.getElementById('sub-btn').textContent = params.get('sub_text');

        // Column Titles
        if(params.get('col1_title')) document.getElementById('col1-title').textContent = params.get('col1_title');
        if(params.get('col2_title')) document.getElementById('col2-title').textContent = params.get('col2_title');
        if(params.get('col3_title')) document.getElementById('col3-title').textContent = params.get('col3_title');

        // Helper to add links
        function addLinks(colId, prefix) {
            const container = document.getElementById(colId);
            for(let i=1; i<=5; i++) {
                if(params.get(`${prefix}_link${i}`)) {
                    const a = document.createElement('a');
                    a.href = params.get(`${prefix}_url${i}`) || '#';
                    a.textContent = params.get(`${prefix}_link${i}`);
                    container.appendChild(a);
                }
            }
        }
        
        addLinks('col1', 'col1');
        addLinks('col2', 'col2');
        addLinks('col3', 'col3');
        sendHeight();
        }

        const sendHeight = () => { if(frameId) window.parent.postMessage({frameId: frameId, frameHeight: document.body.scrollHeight}, '*'); }
        window.addEventListener('resize', sendHeight);
        verifyToken();
    </script>
</body>
</html>