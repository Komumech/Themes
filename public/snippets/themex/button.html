<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThemeX Button â€” Professional Bridge</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #05e26c;
            --accent2: #05e26c;
            --primary-text-color: #042024;
            --radius: 10px;
            --comp-width: auto;
        }
        body {
            margin: 0;
            padding: 0;
            background-color: transparent;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .link-wrapper {
            display: inline-flex;
            padding: 10px; 
            text-decoration: none;
            box-sizing: border-box; /* Prevents padding from expanding width */
            width: var(--comp-width);
            max-width: 100%;
            justify-content: center;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 12px 24px;
            border-radius: var(--radius);
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            border: 1px solid transparent;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
            white-space: nowrap;
            width: 100%;
            box-sizing: border-box;
        }

        /* ICON ANIMATION */
        .btn i { transition: transform 0.2s ease; }
        @keyframes icon-shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            50% { transform: rotate(-15deg); }
            75% { transform: rotate(10deg); }
        }
        .btn.animate-shake:hover i { animation: icon-shake 0.4s ease-in-out; }

        /* BUTTON TYPES */
        .btn-primary {
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            color: var(--primary-text-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15); }
        
        .btn-ghost { background: transparent; color: inherit; border: 1px solid rgba(0, 0, 0, 0.1); }
        .btn-ghost:hover { background: rgba(0, 0, 0, 0.05); }

        .btn-outline { background: transparent; color: var(--accent); border: 2px solid var(--accent); }
    </style>
</head>
<body>

    <a href="#" id="link-wrapper" class="link-wrapper">
        <div id="dynamic-btn" class="btn">
            <i id="btn-icon" style="display: none;"></i>
            <span id="btn-text">Button</span>
        </div>
    </a>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const params = new URLSearchParams(window.location.search);
            const root = document.documentElement;
            
            // 1. IMPROVED WIDTH BRIDGE
            const desktopWidth = params.get('width');
            const androidWidth = params.get('android_width');
            const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            
            let finalWidth = 'auto';

            if (isMobile && androidWidth) {
                // Smart Unit Logic: Numbers <= 100 are %, > 100 are px
                if (!isNaN(androidWidth)) {
                    finalWidth = (parseInt(androidWidth) <= 100) ? androidWidth + '%' : androidWidth + 'px';
                } else {
                    finalWidth = androidWidth;
                }
            } else if (desktopWidth && desktopWidth !== 'auto') {
                finalWidth = isNaN(desktopWidth) ? desktopWidth + 'px' : desktopWidth;
            }

            root.style.setProperty('--comp-width', finalWidth);

            // 2. STYLE BRIDGE
            const accent = params.get('accent_color');
            const accent2 = params.get('accent2_color');
            const textCol = params.get('primary_text_color');
            const radius = params.get('radius');

            if (accent) {
                root.style.setProperty('--accent', `#${accent}`);
                root.style.setProperty('--accent2', accent2 ? `#${accent2}` : `#${accent}`);
            }
            if (textCol) root.style.setProperty('--primary-text-color', `#${textCol}`);
            if (radius) root.style.setProperty('--radius', radius + (isNaN(radius) ? '' : 'px'));

            // 3. CONTENT BRIDGE
            document.getElementById('btn-text').textContent = params.get('text') || 'Click Me';
            document.getElementById('link-wrapper').href = params.get('href') || '#';
            document.getElementById('link-wrapper').target = '_parent';
            
            const type = params.get('type') || 'primary';
            document.getElementById('dynamic-btn').classList.add(`btn-${type}`);

            // 4. ICON & ANIMATION
            const iconName = params.get('icon');
            const iconPos = params.get('icon_pos') || 'left';
            const shouldAnimate = params.get('animate') !== 'false';

            if (iconName) {
                const iconEl = document.getElementById('btn-icon');
                iconEl.className = `fas fa-${iconName}`;
                iconEl.style.display = 'inline-block';
                if (iconPos === 'right') document.getElementById('dynamic-btn').appendChild(iconEl);
                if (shouldAnimate) document.getElementById('dynamic-btn').classList.add('animate-shake');
            }

            // 5. RESIZE OBSERVER
            const frameId = params.get('frame_id');
            if (frameId && window.parent) {
                new ResizeObserver(() => {
                    window.parent.postMessage({ frameId, frameHeight: Math.ceil(document.body.offsetHeight) }, '*');
                }).observe(document.body);
            }
        });
    </script>
</body>
</html>